<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>NASA Giovanni</title>

        <link href="src/style.css" rel="stylesheet" />
        <script type="module" src="src/main.ts"></script>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@nasa-terra/components@0.0.116/cdn/themes/horizon.css" />

        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
            rel="stylesheet"
        />
    </head>

    <body class="bg-gray-50 font-sans">
        <div class="flex flex-col h-screen">
            <header
                class="bg-white border-b border-gray-200 p-4 flex items-center justify-between nasa-bg-blue text-white"
            >
                <div class="flex items-center space-x-3">
                    <div>
                        <h1 class="text-2xl inter inter-bold inter-italic">
                            Giovanni
                        </h1>
                        <p class="text-xs opacity-90 inter-italic">
                            The bridge between data and science
                        </p>
                    </div>
                </div>
                <div class="flex items-center">
                    <terra-button variant="text">
                        <span class="text-gray-200 hover:text-white flex items-center">
                            Help
                            <terra-icon name="outline-chevron-down" library="heroicons" class="w-4 h-4 ml-1"></terra-icon>
                        </span>
                    </terra-button>

                    <terra-button variant="text">
                        <span class="text-gray-200 hover:text-white flex items-center">
                            Earthdata Forum
                            <terra-icon name="outline-arrow-top-right-on-square" library="heroicons" class="w-4 h-4 ml-1"></terra-icon>
                        </span>
                    </terra-button>
                    
                    <terra-login id="login" button-label="Login" class="ml-3">
                        <div slot="logged-in" id="logout">
                            <!-- empty container that will be populated with the logout button -->
                        </div>
                    </terra-login>
                </div>
            </header>

            <div class="flex flex-1">
                <aside
                    id="sidebar"
                    class="bg-gray-50 shadow-lg border-r border-gray-200 flex flex-col"
                    style="width: 500px; min-width: 300px; max-width: 2000px;"
                >
                    <div
                        class="flex-1 overflow-y-auto custom-scrollbar p-4 space-y-4"
                    >
                        <!-- Plot Type Selector -->
                        <section class="bg-white rounded-lg p-4 shadow-sm">
                            <h3 class="text-sm font-semibold text-gray-700 mb-3">Plot Type</h3>
                            <div class="flex space-x-2">
                                <button
                                    id="map-button"
                                    class="plot-type-button plot-type-button--unselected"
                                    data-plot-type="map"
                                >
                                    <svg class="plot-type-icon plot-type-icon--unselected" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m-6 3l6-3"/>
                                    </svg>
                                    <span class="plot-type-label plot-type-label--unselected">Map</span>
                                </button>
                                <button
                                    id="plot-button"
                                    class="plot-type-button plot-type-button--selected"
                                    data-plot-type="plot"
                                >
                                    <svg class="plot-type-icon plot-type-icon--selected" fill="currentColor" stroke="currentColor" viewBox="0 0 57 49">
                                        <g clip-path="url(#clip0_62845_16438)">
                                            <path d="M7.5 3.6748C7.5 1.98086 5.93594 0.612305 4 0.612305C2.06406 0.612305 0.5 1.98086 0.5 3.6748V40.7311C0.5 44.9611 4.41562 48.3873 9.25 48.3873H53C54.9359 48.3873 56.5 47.0187 56.5 45.3248C56.5 43.6309 54.9359 42.2623 53 42.2623H9.25C8.2875 42.2623 7.5 41.5732 7.5 40.7311V3.6748ZM54.7719 14.4127C56.1391 13.2164 56.1391 11.2736 54.7719 10.0773C53.4047 8.88105 51.1844 8.88105 49.8172 10.0773L38.3 20.1645L32.0219 14.6711C30.6547 13.4748 28.4344 13.4748 27.0672 14.6711L12.0172 27.8398C10.65 29.0361 10.65 30.9789 12.0172 32.1752C13.3844 33.3715 15.6047 33.3715 16.9719 32.1752L29.55 21.1789L35.8281 26.6723C37.1953 27.8686 39.4156 27.8686 40.7828 26.6723L54.7828 14.4223L54.7719 14.4127Z"/>
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_62845_16438">
                                                <rect width="56" height="49" transform="translate(0.5)"/>
                                            </clipPath>
                                        </defs>
                                    </svg> 
                                    <span class="plot-type-label plot-type-label--selected">Time Series</span>
                                </button>
                            </div>
                        </section>

                        <!-- Variables Section -->
                        <section class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center justify-between mb-3">
                                <h3 class="text-sm font-semibold text-gray-700">Variables</h3>
                                <span
                                    class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full"
                                    id="variable-count"
                                ></span>
                            </div>

                            <div
                                class="space-y-2"
                                role="list"
                                aria-describedby="variables-help"
                                id="selected-variables"
                            ></div>

                            <terra-button
                                id="add-variable-button"
                                class="w-full mt-3"
                                variant="primary"
                            >
                                <terra-icon
                                    name="outline-plus"
                                    library="heroicons"
                                    class="mr-2"
                                ></terra-icon>
                                Add a Variable
                            </terra-button>

                            <terra-dialog
                                id="add-variable-dialog"
                                width="clamp(350px, 77%, 1280px)"
                            >
                                <terra-browse-variables
                                    id="variable-selector"
                                ></terra-browse-variables>
                            </terra-dialog>
                        </section>

                        <!-- Location/Region Section -->
                        <section class="bg-white rounded-lg p-4 shadow-sm">
                            <h3 class="text-sm font-semibold text-gray-700 mb-3">Location / Region</h3>
                            <terra-spatial-picker
                                label=""
                                id="spatial-picker"
                                class="w-full"
                            ></terra-spatial-picker>
                        </section>

                        <!-- Date Range Section -->
                        <section class="bg-white rounded-lg p-4 shadow-sm">
                            <h3 class="text-sm font-semibold text-gray-700 mb-3">Date Range</h3>
                            <terra-date-picker
                                label=""
                                range
                                show-months="2"
                                class="w-full"
                                id="date-range"
                            ></terra-date-picker>
                        </section>
                    </div>

                    <div class="p-4 border-t border-gray-200 sticky bottom-0 bg-gray-50 z-10">
                        <button
                            id="generate-plot-button"
                            class="w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-4 rounded-lg transition-colors duration-200"
                        >
                            Generate Plot
                        </button>
                    </div>
                </aside>

                <div 
                    id="resize-handle" 
                    class="w-1 bg-gray-300 hover:bg-gray-400 cursor-col-resize transition-colors duration-200 flex-shrink-0"
                    style="touch-action: none;"
                ></div>

                <main class="flex-1 flex flex-col bg-white">
                    <div class="flex-1 p-6 bg-gray-50 pb-[100px]" id="plots"></div>
                </main>
            </div>

            <div
                id="history-panel"
                class="fixed bottom-0 z-50 right-0 bg-white h-[100px] border-t border-gray-200"
                style="left: 500px;"
            >
                <div
                    class="w-full h-[80px] bg-white flex items-center px-4 relative"
                >
                    <!-- Grid button -->
                    <button
                        id="grid-button"
                        class="flex-shrink-0 w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors duration-200 mr-2 hidden"
                    >
                        <svg
                            class="w-5 h-5"
                            fill="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                d="M3 3h7v7H3V3zm0 11h7v7H3v-7zm11-11h7v7h-7V3zm0 11h7v7h-7v-7z"
                            />
                        </svg>
                    </button>

                    <!-- Left arrow -->
                    <button
                        id="left-arrow"
                        class="flex-shrink-0 w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors duration-200 mr-2 cursor-pointer pt-[15px]"
                    >
                        <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M15 19l-7-7 7-7"
                            />
                        </svg>
                    </button>

                    <!-- Thumbnails container -->
                    <div class="flex-1 relative overflow-hidden">
                        <div
                            id="thumbnails-container"
                            class="flex space-x-3 transition-transform duration-300 ease-in-out pt-[15px]"
                        >
                            <!-- Thumbnails will be rendered here -->
                        </div>
                    </div>

                    <!-- Right arrow -->
                    <button
                        id="right-arrow"
                        class="flex-shrink-0 w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors duration-200 ml-2 cursor-pointer pt-[15px]"
                    >
                        <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M9 5l7 7-7 7"
                            />
                        </svg>
                    </button>
                </div>
            </div>
            </div>
        </div>

        <div
            id="login-modal"
            class="fixed inset-0 z-500 flex items-center justify-center modal"
            style="display: none"
        >
            <div
                id="login-overlay"
                class="bg-white rounded-lg shadow-xl p-8 max-w-md w-full mx-4"
            >
                <div class="text-center">
                    <div
                        class="nasa-bg-blue rounded-full w-16 h-16 mx-auto mb-6 flex items-center justify-center"
                    >
                        <svg
                            class="w-8 h-8 text-white"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"
                            />
                        </svg>
                    </div>

                    <h2 class="text-2xl font-bold text-gray-900 mb-4">
                        Login Required
                    </h2>

                    <p class="text-gray-600 mb-8">
                        Please log in to your NASA Earthdata account to create plots
                        and access data.
                    </p>

                    <button
                        id="login-modal-button"
                        class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center mx-auto cursor-pointer"
                    >
                        <svg
                            class="w-5 h-5 mr-2"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"
                            />
                        </svg>
                        Login to NASA Earthdata
                    </button>
                </div>
            </div>
        </div>

        <div
            class="fixed px-3 py-2 bg-gray-800 text-white text-xs rounded-lg shadow-lg opacity-0 pointer-events-none whitespace-nowrap z-50 transition-opacity duration-200 z-200"
            id="thumbnail-tooltip"
        ></div>

        <script src="https://cdn.plot.ly/plotly-3.1.0.min.js" charset="utf-8"></script>
    </body>
</html>
